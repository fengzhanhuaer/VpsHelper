{% extends "base.html" %}
{% block content %}
  <div class="top-actions" style="justify-content: flex-start; gap: 8px;">
    <a class="ghost" href="{{ url_for('tg_helper') }}">返回Tg助手</a>
    <a class="ghost" href="{{ url_for('logout') }}">退出登录</a>
  </div>
  <h1>账号管理</h1>
  <p>添加、查看、删除多个 Telegram 账号。</p>

  {% if error %}
    <div class="error">{{ error }}</div>
  {% endif %}

  <form method="post" action="{{ url_for('tg_login_start') }}" style="margin-bottom: 18px;">
    <div class="field">
      <label for="phone">手机号</label>
      <input id="phone" name="phone" placeholder="+8613xxxx" required />
    </div>
    <div class="field">
      <label for="login_account_name">账号名称（可选）</label>
      <input id="login_account_name" name="account_name" placeholder="例如：主账号" />
    </div>
    <button class="btn" type="submit">手机登录</button>
  </form>

  <div id="auto-sign" style="margin-top: 18px;">
    <h2 style="font-size: 16px; margin: 0 0 10px;">已保存账号</h2>
    {% if accounts %}
      {% for account in accounts %}
        <div style="border: 1px solid #e5e7eb; border-radius: 10px; padding: 10px 12px; margin-bottom: 10px;">
          <div style="font-weight: 600;">{{ account["account_name"] }}</div>
          <div style="font-size: 12px; color: #6b7280; margin: 6px 0;">
            会话：{{ account["session_text"] }}
          </div>
          <form method="post" action="{{ url_for('delete_account', account_id=account['id']) }}">
            <button class="ghost" type="submit">删除</button>
          </form>
        </div>
      {% endfor %}
    {% else %}
      <p style="color:#6b7280;">暂无账号，请先添加。</p>
    {% endif %}
  </div>

{% endblock %}
