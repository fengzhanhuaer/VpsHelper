{% extends "base.html" %}

{% block title %}è´¦å·ç®¡ç† - TGåŠ©æ‰‹{% endblock %}

{% block content %}
<h1>ğŸ‘¥ TGè´¦å·ç®¡ç†</h1>

<div style="margin-bottom: 30px; text-align: right;">
    <a href="#" class="btn" onclick="showAddForm(); return false;">â• æ·»åŠ è´¦å·</a>
</div>

<div id="addFormContainer" style="display: none; margin-bottom: 30px; padding: 20px; background: #f8f9fa; border-radius: 10px;">
    <h3 style="color: #667eea; margin-bottom: 20px;">æ·»åŠ æ–°è´¦å·</h3>
    <form method="POST" action="{{ url_for('tg_accounts') }}">
        <div class="form-group">
            <label for="phone">æ‰‹æœºå·</label>
            <input type="text" id="phone" name="phone" required 
                   placeholder="è¯·è¾“å…¥æ‰‹æœºå·ï¼ˆå«å›½å®¶ä»£ç ï¼‰">
        </div>

        <div class="form-group">
            <label for="api_id">API ID</label>
            <input type="text" id="api_id" name="api_id" required 
                   placeholder="è¯·è¾“å…¥Telegram API ID">
        </div>

        <div class="form-group">
            <label for="api_hash">API Hash</label>
            <input type="text" id="api_hash" name="api_hash" required 
                   placeholder="è¯·è¾“å…¥Telegram API Hash">
        </div>

        <div class="form-group">
            <label for="note">å¤‡æ³¨</label>
            <input type="text" id="note" name="note" 
                   placeholder="è´¦å·å¤‡æ³¨ï¼ˆå¯é€‰ï¼‰">
        </div>

        <div class="form-group" style="display: flex; gap: 10px; justify-content: center;">
            <button type="submit" class="btn">ä¿å­˜</button>
            <button type="button" class="btn btn-secondary" onclick="hideAddForm()">å–æ¶ˆ</button>
        </div>
    </form>
</div>

{% if accounts %}
<div style="overflow-x: auto;">
    <table>
        <thead>
            <tr>
                <th>æ‰‹æœºå·</th>
                <th>API ID</th>
                <th>çŠ¶æ€</th>
                <th>å¤‡æ³¨</th>
                <th>æ·»åŠ æ—¶é—´</th>
                <th>æ“ä½œ</th>
            </tr>
        </thead>
        <tbody>
            {% for account in accounts %}
            <tr>
                <td>{{ account.phone }}</td>
                <td>{{ account.api_id }}</td>
                <td>
                    <span style="color: {{ 'green' if account.is_active else 'red' }}; font-weight: 600;">
                        {{ 'âœ“ æ´»è·ƒ' if account.is_active else 'âœ— æœªæ¿€æ´»' }}
                    </span>
                </td>
                <td>{{ account.note or '-' }}</td>
                <td>{{ account.created_at.strftime('%Y-%m-%d %H:%M') if account.created_at else '-' }}</td>
                <td>
                    <a href="#" style="color: #667eea; text-decoration: none; margin-right: 10px;">ç¼–è¾‘</a>
                    <a href="#" style="color: #dc3545; text-decoration: none;" 
                       onclick="return confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªè´¦å·å—ï¼Ÿ')">åˆ é™¤</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<div style="text-align: center; padding: 40px; color: #999;">
    <p style="font-size: 1.2em;">æš‚æ— è´¦å·</p>
    <p>ç‚¹å‡»ä¸Šæ–¹"æ·»åŠ è´¦å·"æŒ‰é’®æ¥æ·»åŠ æ‚¨çš„ç¬¬ä¸€ä¸ªTGè´¦å·</p>
</div>
{% endif %}

<div class="back-button">
    <a href="{{ url_for('tg_helper') }}" class="btn btn-secondary">â¬…ï¸ è¿”å›TGåŠ©æ‰‹</a>
</div>

<script>
function showAddForm() {
    document.getElementById('addFormContainer').style.display = 'block';
}

function hideAddForm() {
    document.getElementById('addFormContainer').style.display = 'none';
}
</script>
{% endblock %}
